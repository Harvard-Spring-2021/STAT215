res_ZAligned.sortedByCoord.out <- c(0.0,0.00754147812971,0.0241327300151,0.0920060331825,0.105580693816,0.0859728506787,0.150829562594,0.254901960784,0.303167420814,0.334841628959,0.300150829563,0.361990950226,0.487179487179,0.580693815988,0.684766214178,0.662141779789,0.52790346908,0.493212669683,0.43137254902,0.377073906486,0.374057315234,0.457013574661,0.790346907994,0.901960784314,0.766214177979,0.83257918552,0.808446455505,0.77677224736,0.909502262443,0.668174962293,0.533936651584,0.478129713424,0.441930618401,0.426847662142,0.414781297134,0.609351432881,0.772247360483,0.846153846154,1.0,0.669683257919,0.663650075415,0.642533936652,0.739064856712,0.742081447964,0.702865761689,0.645550527903,0.633484162896,0.684766214178,0.684766214178,0.662141779789,0.546003016591,0.40874811463,0.36802413273,0.363499245852,0.432880844646,0.621417797888,0.79185520362,0.889894419306,0.90346907994,0.912518853695,0.897435897436,0.886877828054,0.778280542986,0.619909502262,0.532428355958,0.490196078431,0.419306184012,0.36802413273,0.371040723982,0.32730015083,0.450980392157,0.598793363499,0.588235294118,0.449472096531,0.40874811463,0.363499245852,0.226244343891,0.260935143288,0.257918552036,0.242835595777,0.262443438914,0.282051282051,0.273001508296,0.268476621418,0.235294117647,0.194570135747,0.15987933635,0.116138763198,0.116138763198,0.156862745098,0.158371040724,0.15987933635,0.107088989442,0.0889894419306,0.0739064856712,0.0437405731523,0.0573152337858,0.0769230769231,0.0633484162896,0.0346907993967)
res_WAligned.sortedByCoord.out <- c(0.0,0.0589348283111,0.165662228451,0.296215837421,0.373791170287,0.463419761738,0.538402242467,0.580308339173,0.564681149264,0.551786965662,0.615767344078,0.668745620182,0.710651716889,0.756972669937,0.747302032235,0.707217939734,0.751576734408,0.826559215137,0.837000700771,0.843517869657,0.86096706377,0.871268395235,0.861457603364,0.877575332866,0.858163980378,0.86096706377,0.881149264191,0.885003503854,0.897337070778,0.906377014716,0.909039943938,0.894463910301,0.896426068676,0.905395935529,0.912824106517,0.935038542397,0.94225648213,0.947021723896,0.956902592852,0.981569726699,1.0,0.98318149965,0.997056762439,0.980378416258,0.967063770147,0.94400840925,0.910021023125,0.912894183602,0.864540995095,0.880448493343,0.83742116328,0.829292221444,0.861737911703,0.887386124737,0.897126839523,0.918640504555,0.950245269797,0.914435879467,0.905536089699,0.86769446391,0.885003503854,0.880798878767,0.907288016819,0.896846531184,0.911422564821,0.918430273301,0.92046250876,0.919341275403,0.941275402943,0.917729502453,0.893342676945,0.854870357393,0.851716888577,0.814786264891,0.801822004205,0.806377014716,0.783742116328,0.779467414156,0.770847932726,0.765241765943,0.751646811493,0.73391730904,0.721163279608,0.70497547302,0.639383321654,0.674211632796,0.653959355291,0.638262088297,0.600280308339,0.593552908199,0.563139453399,0.5,0.4576033637,0.415697266994,0.359495444989,0.299719691661,0.236720392432,0.161597757533,0.0963559915907,0.025087596356)
res_XAligned.sortedByCoord.out <- c(0.0,0.0682561944834,0.169861305906,0.31317853618,0.3939016155,0.50677886863,0.578723183211,0.63098020882,0.644589891434,0.637421432653,0.690977092099,0.733052828424,0.76723287102,0.814762869461,0.822606617838,0.803906290582,0.837930497117,0.86909770921,0.875746714456,0.886343566568,0.894810659187,0.922913095424,0.915848527349,0.927640122591,0.912991532907,0.926237598047,0.951171367721,0.946132668433,0.958651498623,0.965612175991,0.954184198223,0.945769050958,0.94758713833,0.963794088619,0.960054023168,0.965352449223,0.958547607916,0.96857306114,0.982338579814,0.986286426679,1.0,0.973455924368,0.988208404758,0.990130382837,0.969715858916,0.944834034596,0.925042854917,0.929614046024,0.890551140201,0.895122331307,0.859955326996,0.86255259467,0.899589631707,0.90587501948,0.895693730196,0.905251675238,0.922913095424,0.894914549894,0.878863435666,0.854397174173,0.857358059322,0.85361799387,0.885148823438,0.883226845359,0.889512233131,0.881720430108,0.883798244247,0.868214638201,0.882811282531,0.857358059322,0.841514726508,0.797049503922,0.805256869773,0.797828684224,0.774557165862,0.769050958392,0.753779024466,0.736844839229,0.729104981559,0.712949976625,0.697729988053,0.68131525635,0.66329021869,0.644537946081,0.597994909355,0.61638356449,0.591397849462,0.574151992104,0.533167108202,0.520596332658,0.497896213184,0.444028881617,0.400550620747,0.368863955119,0.319827541426,0.26180458158,0.19926237598,0.128720585944,0.0746454729624,0.0172978027115)
res_YAligned.sortedByCoord.out <- c(0.0,0.0889378478664,0.192775974026,0.324443413729,0.408337198516,0.503884508349,0.582850185529,0.637175324675,0.668889146568,0.673759276438,0.724489795918,0.764146567718,0.800150742115,0.826936456401,0.852678571429,0.839459647495,0.860911410019,0.892161410019,0.899988404453,0.90306122449,0.91784554731,0.943007884972,0.935876623377,0.93732606679,0.95228432282,0.978548237477,0.996521335807,0.999768089054,0.986549165121,0.974953617811,0.981621057514,0.977040816327,0.973330241187,0.981968923933,0.992868738404,0.990491651206,0.982374768089,0.996057513915,1.0,0.990375695733,0.998782467532,0.984635899814,0.994608070501,0.990433673469,0.981331168831,0.953443877551,0.951820500928,0.944457328386,0.917787569573,0.922947588126,0.901263914657,0.890653988868,0.920628478664,0.928687384045,0.926658163265,0.909728664193,0.92457096475,0.896683673469,0.879116419295,0.852446660482,0.860679499072,0.854997680891,0.880855751391,0.863520408163,0.871115491651,0.867288961039,0.854417903525,0.836560760668,0.844735621521,0.829545454545,0.818181818182,0.783685064935,0.789714749536,0.769306586271,0.752551020408,0.739621985158,0.725707328386,0.718518089054,0.704835343228,0.699965213358,0.684369202226,0.66112012987,0.640190166976,0.609172077922,0.574849257885,0.588010204082,0.565224953618,0.541859925788,0.502029220779,0.484983766234,0.45866187384,0.415758348794,0.380855751391,0.343692022263,0.30780380334,0.261189703154,0.188717532468,0.122680890538,0.0671961966605,0.00805890538033)
data_matrix <- matrix(c(res_ZAligned.sortedByCoord.out,res_WAligned.sortedByCoord.out,res_XAligned.sortedByCoord.out,res_YAligned.sortedByCoord.out), byrow=T, ncol=100)
rowLabel <- c("res_ZAligned.sortedByCoord.out","res_WAligned.sortedByCoord.out","res_XAligned.sortedByCoord.out","res_YAligned.sortedByCoord.out")


pdf("geneBodyCoverage.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("geneBodyCoverage.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(4)
plot(x,res_ZAligned.sortedByCoord.out,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,res_WAligned.sortedByCoord.out,type='l',col=icolor[2])
lines(x,res_XAligned.sortedByCoord.out,type='l',col=icolor[3])
lines(x,res_YAligned.sortedByCoord.out,type='l',col=icolor[4])
legend(0,1,fill=icolor[1:4], legend=c('res_ZAligned.sortedByCoord.out','res_WAligned.sortedByCoord.out','res_XAligned.sortedByCoord.out','res_YAligned.sortedByCoord.out'))
dev.off()
